version: "3.9"

# ===============================
# Vehicle Service Docker Compose
# ===============================
# 
# ‚ö†Ô∏è DATABASE INFRASTRUCTURE CHANGE:
# PostgreSQL database is now managed centrally in infrastructure/data/
# You must start the data infrastructure first:
#   cd ../../infrastructure/data && docker-compose up -d
#
# Database Connection:
# - Uses postgres-vehicle from fleet-data-network
# - Local dev: localhost:7433
# - Docker: postgres-vehicle:5432
#
# Database Initialization:
# - Schema: Created automatically via Entity Framework migrations
# - Sample Data: Seeded automatically by DatabaseSeeder.cs on first run
# - The seeder is idempotent - safe to run multiple times
#
# Ports:
# - Vehicle Service: localhost:7001
#
# üìö Documentation:
# - Database Setup: See ../../infrastructure/data/README.md
# - pgAdmin Access: http://localhost:5050 (centralized instance)
# - API Documentation: See README.md for service endpoints and usage

services:
  vehicle-service:
    build:
      context: ./VehicleService
      dockerfile: ./VehicleService.Api/Dockerfile
    container_name: vehicle-service
    ports:
      - "7001:8080"
    environment:
      ASPNETCORE_ENVIRONMENT: Development
      ConnectionStrings__DefaultConnection: "Host=postgres-vehicle;Port=5432;Database=vehicle_db;Username=postgres;Password=postgres"
      ASPNETCORE_URLS: "http://+:8080"
      CORS_ORIGINS: "*"
    volumes:
      - ./VehicleService:/src/VehicleService
    restart: always
    networks:
      - fleet-data-network

networks:
  fleet-data-network:
    external: true
